<?xml version="1.0" encoding="UTF-8"?>
<testsuites>
  <testsuite name="/workspace/phpunit.xml" tests="7" assertions="21" errors="0" failures="2" skipped="0" time="2.035038">
    <testsuite name="Feature" tests="7" assertions="21" errors="0" failures="2" skipped="0" time="2.035038">
      <testsuite name="Tests\Feature\Export\BalanceSheetExportTest" file="/workspace/tests/Feature/Export/BalanceSheetExportTest.php" tests="1" assertions="4" errors="0" failures="0" skipped="0" time="0.412985">
        <testcase name="test_balance_sheet_pdf_export_returns_pdf" file="/workspace/tests/Feature/Export/BalanceSheetExportTest.php" line="21" class="Tests\Feature\Export\BalanceSheetExportTest" classname="Tests.Feature.Export.BalanceSheetExportTest" assertions="4" time="0.412985"/>
      </testsuite>
      <testsuite name="Tests\Feature\Export\IncomeStatementExportTest" file="/workspace/tests/Feature/Export/IncomeStatementExportTest.php" tests="1" assertions="4" errors="0" failures="0" skipped="0" time="0.272038">
        <testcase name="test_income_statement_pdf_export_returns_pdf" file="/workspace/tests/Feature/Export/IncomeStatementExportTest.php" line="21" class="Tests\Feature\Export\IncomeStatementExportTest" classname="Tests.Feature.Export.IncomeStatementExportTest" assertions="4" time="0.272038"/>
      </testsuite>
      <testsuite name="Tests\Feature\Export\PurchaseExportTest" file="/workspace/tests/Feature/Export/PurchaseExportTest.php" tests="1" assertions="1" errors="0" failures="1" skipped="0" time="0.221324">
        <testcase name="test_purchase_pdf_export_returns_pdf" file="/workspace/tests/Feature/Export/PurchaseExportTest.php" line="21" class="Tests\Feature\Export\PurchaseExportTest" classname="Tests.Feature.Export.PurchaseExportTest" assertions="1" time="0.221324">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Export\PurchaseExportTest::test_purchase_pdf_export_returns_pdf
Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'tenant_demo_test.purchases' doesn't exist in /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php:409
Stack trace:
#0 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(409): PDOStatement-&gt;execute()
#1 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(809): Illuminate\Database\Connection-&gt;{closure:Illuminate\Database\Connection::select():395}()
#2 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(776): Illuminate\Database\Connection-&gt;runQueryCallback()
#3 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(395): Illuminate\Database\Connection-&gt;run()
#4 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3131): Illuminate\Database\Connection-&gt;select()
#5 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3116): Illuminate\Database\Query\Builder-&gt;runSelect()
#6 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3706): Illuminate\Database\Query\Builder-&gt;{closure:Illuminate\Database\Query\Builder::get():3115}()
#7 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3115): Illuminate\Database\Query\Builder-&gt;onceWithColumns()
#8 /workspace/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(872): Illuminate\Database\Query\Builder-&gt;get()
#9 /workspace/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(854): Illuminate\Database\Eloquent\Builder-&gt;getModels()
#10 /workspace/app/Http/Controllers/Admin/ReportController.php(128): Illuminate\Database\Eloquent\Builder-&gt;get()
#11 /workspace/app/Http/Controllers/Admin/ReportController.php(347): App\Http\Controllers\Admin\ReportController-&gt;getPurchaseReportData()
#12 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): App\Http\Controllers\Admin\ReportController-&gt;purchaseExport()
#13 /workspace/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(43): Illuminate\Routing\Controller-&gt;callAction()
#14 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Route.php(265): Illuminate\Routing\ControllerDispatcher-&gt;dispatch()
#15 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Route.php(211): Illuminate\Routing\Route-&gt;runController()
#16 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(808): Illuminate\Routing\Route-&gt;run()
#17 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(169): Illuminate\Routing\Router-&gt;{closure:Illuminate\Routing\Router::runRouteWithinStack():807}()
#18 /workspace/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline-&gt;{closure:Illuminate\Pipeline\Pipeline::prepareDestination():167}()
#19 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Barryvdh\Debugbar\Middleware\InjectDebugbar-&gt;handle()
#20 /workspace/vendor/spatie/laravel-multitenancy/src/Http/Middleware/EnsureValidTenantSession.php(20): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#21 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Spatie\Multitenancy\Http\Middleware\EnsureValidTenantSession-&gt;handle()
#22 /workspace/vendor/spatie/laravel-multitenancy/src/Http/Middleware/NeedsTenant.php(17): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#23 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Spatie\Multitenancy\Http\Middleware\NeedsTenant-&gt;handle()
#24 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#25 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle()
#26 /workspace/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(63): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#27 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Auth\Middleware\Authenticate-&gt;handle()
#28 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(87): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#29 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken-&gt;handle()
#30 /workspace/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(48): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#31 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\View\Middleware\ShareErrorsFromSession-&gt;handle()
#32 /workspace/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(120): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#33 /workspace/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\Session\Middleware\StartSession-&gt;handleStatefulRequest()
#34 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Session\Middleware\StartSession-&gt;handle()
#35 /workspace/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(36): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#36 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse-&gt;handle()
#37 /workspace/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(74): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#38 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Cookie\Middleware\EncryptCookies-&gt;handle()
#39 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(126): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#40 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then()
#41 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack()
#42 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router-&gt;runRoute()
#43 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute()
#44 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router-&gt;dispatch()
#45 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(169): Illuminate\Foundation\Http\Kernel-&gt;{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():197}()
#46 /workspace/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline-&gt;{closure:Illuminate\Pipeline\Pipeline::prepareDestination():167}()
#47 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware-&gt;handle()
#48 /workspace/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#49 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Barryvdh\Debugbar\Middleware\InjectDebugbar-&gt;handle()
#50 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#51 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle()
#52 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle()
#53 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#54 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle()
#55 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle()
#56 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#57 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle()
#58 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(109): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#59 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle()
#60 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(48): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#61 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\HandleCors-&gt;handle()
#62 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#63 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\TrustProxies-&gt;handle()
#64 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#65 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle()
#66 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#67 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\ValidatePathEncoding-&gt;handle()
#68 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(126): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#69 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline-&gt;then()
#70 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter()
#71 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle()
#72 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase-&gt;call()
#73 /workspace/tests/Feature/Export/PurchaseExportTest.php(25): Illuminate\Foundation\Testing\TestCase-&gt;get()
#74 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(1656): Tests\Feature\Export\PurchaseExportTest-&gt;test_purchase_pdf_export_returns_pdf()
#75 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(514): PHPUnit\Framework\TestCase-&gt;runTest()
#76 /workspace/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#77 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner-&gt;run()
#78 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#79 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#80 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#81 /workspace/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#82 /workspace/vendor/phpunit/phpunit/src/TextUI/Application.php(210): PHPUnit\TextUI\TestRunner-&gt;run()
#83 /workspace/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application-&gt;run()
#84 /workspace/vendor/bin/phpunit(122): include('...')
#85 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'tenant_demo_test.purchases' doesn't exist (Connection: tenant, SQL: select * from `purchases` where `purchase_date` between 2025-01-01 00:00:00 and 2025-12-31 23:59:59) in /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php:822
Stack trace:
#0 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(776): Illuminate\Database\Connection-&gt;runQueryCallback()
#1 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(395): Illuminate\Database\Connection-&gt;run()
#2 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3131): Illuminate\Database\Connection-&gt;select()
#3 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3116): Illuminate\Database\Query\Builder-&gt;runSelect()
#4 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3706): Illuminate\Database\Query\Builder-&gt;{closure:Illuminate\Database\Query\Builder::get():3115}()
#5 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3115): Illuminate\Database\Query\Builder-&gt;onceWithColumns()
#6 /workspace/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(872): Illuminate\Database\Query\Builder-&gt;get()
#7 /workspace/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(854): Illuminate\Database\Eloquent\Builder-&gt;getModels()
#8 /workspace/app/Http/Controllers/Admin/ReportController.php(128): Illuminate\Database\Eloquent\Builder-&gt;get()
#9 /workspace/app/Http/Controllers/Admin/ReportController.php(347): App\Http\Controllers\Admin\ReportController-&gt;getPurchaseReportData()
#10 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): App\Http\Controllers\Admin\ReportController-&gt;purchaseExport()
#11 /workspace/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(43): Illuminate\Routing\Controller-&gt;callAction()
#12 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Route.php(265): Illuminate\Routing\ControllerDispatcher-&gt;dispatch()
#13 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Route.php(211): Illuminate\Routing\Route-&gt;runController()
#14 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(808): Illuminate\Routing\Route-&gt;run()
#15 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(169): Illuminate\Routing\Router-&gt;{closure:Illuminate\Routing\Router::runRouteWithinStack():807}()
#16 /workspace/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline-&gt;{closure:Illuminate\Pipeline\Pipeline::prepareDestination():167}()
#17 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Barryvdh\Debugbar\Middleware\InjectDebugbar-&gt;handle()
#18 /workspace/vendor/spatie/laravel-multitenancy/src/Http/Middleware/EnsureValidTenantSession.php(20): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#19 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Spatie\Multitenancy\Http\Middleware\EnsureValidTenantSession-&gt;handle()
#20 /workspace/vendor/spatie/laravel-multitenancy/src/Http/Middleware/NeedsTenant.php(17): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#21 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Spatie\Multitenancy\Http\Middleware\NeedsTenant-&gt;handle()
#22 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#23 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle()
#24 /workspace/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(63): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#25 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Auth\Middleware\Authenticate-&gt;handle()
#26 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(87): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#27 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken-&gt;handle()
#28 /workspace/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(48): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#29 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\View\Middleware\ShareErrorsFromSession-&gt;handle()
#30 /workspace/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(120): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#31 /workspace/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\Session\Middleware\StartSession-&gt;handleStatefulRequest()
#32 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Session\Middleware\StartSession-&gt;handle()
#33 /workspace/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(36): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#34 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse-&gt;handle()
#35 /workspace/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(74): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#36 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Cookie\Middleware\EncryptCookies-&gt;handle()
#37 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(126): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#38 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then()
#39 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack()
#40 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router-&gt;runRoute()
#41 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute()
#42 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router-&gt;dispatch()
#43 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(169): Illuminate\Foundation\Http\Kernel-&gt;{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():197}()
#44 /workspace/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline-&gt;{closure:Illuminate\Pipeline\Pipeline::prepareDestination():167}()
#45 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware-&gt;handle()
#46 /workspace/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#47 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Barryvdh\Debugbar\Middleware\InjectDebugbar-&gt;handle()
#48 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#49 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle()
#50 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle()
#51 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#52 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle()
#53 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle()
#54 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#55 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle()
#56 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(109): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#57 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle()
#58 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(48): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#59 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\HandleCors-&gt;handle()
#60 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#61 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\TrustProxies-&gt;handle()
#62 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#63 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle()
#64 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#65 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\ValidatePathEncoding-&gt;handle()
#66 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(126): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#67 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline-&gt;then()
#68 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter()
#69 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle()
#70 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase-&gt;call()
#71 /workspace/tests/Feature/Export/PurchaseExportTest.php(25): Illuminate\Foundation\Testing\TestCase-&gt;get()
#72 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(1656): Tests\Feature\Export\PurchaseExportTest-&gt;test_purchase_pdf_export_returns_pdf()
#73 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(514): PHPUnit\Framework\TestCase-&gt;runTest()
#74 /workspace/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#75 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner-&gt;run()
#76 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#77 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#78 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#79 /workspace/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#80 /workspace/vendor/phpunit/phpunit/src/TextUI/Application.php(210): PHPUnit\TextUI\TestRunner-&gt;run()
#81 /workspace/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application-&gt;run()
#82 /workspace/vendor/bin/phpunit(122): include('...')
#83 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S02]: Base table or view not found: 1146 Table 'tenant_demo_test.purchases' doesn't exist (Connection: tenant, SQL: select * from `purchases` where `purchase_date` between 2025-01-01 00:00:00 and 2025-12-31 23:59:59)

/workspace/vendor/laravel/framework/src/Illuminate/Testing/TestResponseAssert.php:45
/workspace/vendor/laravel/framework/src/Illuminate/Testing/TestResponse.php:174
/workspace/tests/Feature/Export/PurchaseExportTest.php:27</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\Export\SalesExportTest" file="/workspace/tests/Feature/Export/SalesExportTest.php" tests="1" assertions="5" errors="0" failures="0" skipped="0" time="0.276015">
        <testcase name="test_sales_pdf_export_returns_pdf_with_content_disposition" file="/workspace/tests/Feature/Export/SalesExportTest.php" line="21" class="Tests\Feature\Export\SalesExportTest" classname="Tests.Feature.Export.SalesExportTest" assertions="5" time="0.276015"/>
      </testsuite>
      <testsuite name="Tests\Feature\Export\StockExportTest" file="/workspace/tests/Feature/Export/StockExportTest.php" tests="1" assertions="1" errors="0" failures="1" skipped="0" time="0.323938">
        <testcase name="test_stock_pdf_export_returns_pdf" file="/workspace/tests/Feature/Export/StockExportTest.php" line="21" class="Tests\Feature\Export\StockExportTest" classname="Tests.Feature.Export.StockExportTest" assertions="1" time="0.323938">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Export\StockExportTest::test_stock_pdf_export_returns_pdf
Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'tenant_demo_test.purchases' doesn't exist in /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php:409
Stack trace:
#0 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(409): PDOStatement-&gt;execute()
#1 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(809): Illuminate\Database\Connection-&gt;{closure:Illuminate\Database\Connection::select():395}()
#2 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(776): Illuminate\Database\Connection-&gt;runQueryCallback()
#3 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(395): Illuminate\Database\Connection-&gt;run()
#4 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3131): Illuminate\Database\Connection-&gt;select()
#5 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3116): Illuminate\Database\Query\Builder-&gt;runSelect()
#6 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3706): Illuminate\Database\Query\Builder-&gt;{closure:Illuminate\Database\Query\Builder::get():3115}()
#7 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3115): Illuminate\Database\Query\Builder-&gt;onceWithColumns()
#8 /workspace/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(872): Illuminate\Database\Query\Builder-&gt;get()
#9 /workspace/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(854): Illuminate\Database\Eloquent\Builder-&gt;getModels()
#10 /workspace/app/Http/Controllers/Admin/ReportController.php(206): Illuminate\Database\Eloquent\Builder-&gt;get()
#11 /workspace/app/Http/Controllers/Admin/ReportController.php(364): App\Http\Controllers\Admin\ReportController-&gt;getStockReportData()
#12 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): App\Http\Controllers\Admin\ReportController-&gt;stockExport()
#13 /workspace/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(43): Illuminate\Routing\Controller-&gt;callAction()
#14 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Route.php(265): Illuminate\Routing\ControllerDispatcher-&gt;dispatch()
#15 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Route.php(211): Illuminate\Routing\Route-&gt;runController()
#16 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(808): Illuminate\Routing\Route-&gt;run()
#17 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(169): Illuminate\Routing\Router-&gt;{closure:Illuminate\Routing\Router::runRouteWithinStack():807}()
#18 /workspace/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline-&gt;{closure:Illuminate\Pipeline\Pipeline::prepareDestination():167}()
#19 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Barryvdh\Debugbar\Middleware\InjectDebugbar-&gt;handle()
#20 /workspace/vendor/spatie/laravel-multitenancy/src/Http/Middleware/EnsureValidTenantSession.php(20): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#21 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Spatie\Multitenancy\Http\Middleware\EnsureValidTenantSession-&gt;handle()
#22 /workspace/vendor/spatie/laravel-multitenancy/src/Http/Middleware/NeedsTenant.php(17): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#23 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Spatie\Multitenancy\Http\Middleware\NeedsTenant-&gt;handle()
#24 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#25 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle()
#26 /workspace/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(63): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#27 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Auth\Middleware\Authenticate-&gt;handle()
#28 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(87): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#29 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken-&gt;handle()
#30 /workspace/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(48): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#31 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\View\Middleware\ShareErrorsFromSession-&gt;handle()
#32 /workspace/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(120): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#33 /workspace/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\Session\Middleware\StartSession-&gt;handleStatefulRequest()
#34 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Session\Middleware\StartSession-&gt;handle()
#35 /workspace/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(36): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#36 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse-&gt;handle()
#37 /workspace/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(74): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#38 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Cookie\Middleware\EncryptCookies-&gt;handle()
#39 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(126): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#40 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then()
#41 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack()
#42 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router-&gt;runRoute()
#43 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute()
#44 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router-&gt;dispatch()
#45 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(169): Illuminate\Foundation\Http\Kernel-&gt;{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():197}()
#46 /workspace/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline-&gt;{closure:Illuminate\Pipeline\Pipeline::prepareDestination():167}()
#47 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware-&gt;handle()
#48 /workspace/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#49 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Barryvdh\Debugbar\Middleware\InjectDebugbar-&gt;handle()
#50 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#51 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle()
#52 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle()
#53 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#54 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle()
#55 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle()
#56 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#57 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle()
#58 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(109): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#59 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle()
#60 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(48): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#61 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\HandleCors-&gt;handle()
#62 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#63 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\TrustProxies-&gt;handle()
#64 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#65 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle()
#66 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#67 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\ValidatePathEncoding-&gt;handle()
#68 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(126): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#69 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline-&gt;then()
#70 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter()
#71 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle()
#72 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase-&gt;call()
#73 /workspace/tests/Feature/Export/StockExportTest.php(25): Illuminate\Foundation\Testing\TestCase-&gt;get()
#74 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(1656): Tests\Feature\Export\StockExportTest-&gt;test_stock_pdf_export_returns_pdf()
#75 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(514): PHPUnit\Framework\TestCase-&gt;runTest()
#76 /workspace/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#77 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner-&gt;run()
#78 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#79 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#80 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#81 /workspace/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#82 /workspace/vendor/phpunit/phpunit/src/TextUI/Application.php(210): PHPUnit\TextUI\TestRunner-&gt;run()
#83 /workspace/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application-&gt;run()
#84 /workspace/vendor/bin/phpunit(122): include('...')
#85 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'tenant_demo_test.purchases' doesn't exist (Connection: tenant, SQL: select * from `purchases` where `store_id` = 1 and `purchase_date` &lt; 2025-09-07 00:00:00 and exists (select * from `purchase_items` where `purchases`.`id` = `purchase_items`.`purchase_id` and `product_id` = 1)) in /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php:822
Stack trace:
#0 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(776): Illuminate\Database\Connection-&gt;runQueryCallback()
#1 /workspace/vendor/laravel/framework/src/Illuminate/Database/Connection.php(395): Illuminate\Database\Connection-&gt;run()
#2 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3131): Illuminate\Database\Connection-&gt;select()
#3 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3116): Illuminate\Database\Query\Builder-&gt;runSelect()
#4 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3706): Illuminate\Database\Query\Builder-&gt;{closure:Illuminate\Database\Query\Builder::get():3115}()
#5 /workspace/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3115): Illuminate\Database\Query\Builder-&gt;onceWithColumns()
#6 /workspace/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(872): Illuminate\Database\Query\Builder-&gt;get()
#7 /workspace/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(854): Illuminate\Database\Eloquent\Builder-&gt;getModels()
#8 /workspace/app/Http/Controllers/Admin/ReportController.php(206): Illuminate\Database\Eloquent\Builder-&gt;get()
#9 /workspace/app/Http/Controllers/Admin/ReportController.php(364): App\Http\Controllers\Admin\ReportController-&gt;getStockReportData()
#10 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): App\Http\Controllers\Admin\ReportController-&gt;stockExport()
#11 /workspace/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(43): Illuminate\Routing\Controller-&gt;callAction()
#12 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Route.php(265): Illuminate\Routing\ControllerDispatcher-&gt;dispatch()
#13 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Route.php(211): Illuminate\Routing\Route-&gt;runController()
#14 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(808): Illuminate\Routing\Route-&gt;run()
#15 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(169): Illuminate\Routing\Router-&gt;{closure:Illuminate\Routing\Router::runRouteWithinStack():807}()
#16 /workspace/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline-&gt;{closure:Illuminate\Pipeline\Pipeline::prepareDestination():167}()
#17 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Barryvdh\Debugbar\Middleware\InjectDebugbar-&gt;handle()
#18 /workspace/vendor/spatie/laravel-multitenancy/src/Http/Middleware/EnsureValidTenantSession.php(20): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#19 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Spatie\Multitenancy\Http\Middleware\EnsureValidTenantSession-&gt;handle()
#20 /workspace/vendor/spatie/laravel-multitenancy/src/Http/Middleware/NeedsTenant.php(17): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#21 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Spatie\Multitenancy\Http\Middleware\NeedsTenant-&gt;handle()
#22 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#23 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle()
#24 /workspace/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(63): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#25 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Auth\Middleware\Authenticate-&gt;handle()
#26 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(87): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#27 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken-&gt;handle()
#28 /workspace/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(48): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#29 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\View\Middleware\ShareErrorsFromSession-&gt;handle()
#30 /workspace/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(120): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#31 /workspace/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\Session\Middleware\StartSession-&gt;handleStatefulRequest()
#32 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Session\Middleware\StartSession-&gt;handle()
#33 /workspace/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(36): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#34 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse-&gt;handle()
#35 /workspace/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(74): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#36 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Cookie\Middleware\EncryptCookies-&gt;handle()
#37 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(126): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#38 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then()
#39 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack()
#40 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router-&gt;runRoute()
#41 /workspace/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute()
#42 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router-&gt;dispatch()
#43 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(169): Illuminate\Foundation\Http\Kernel-&gt;{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():197}()
#44 /workspace/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline-&gt;{closure:Illuminate\Pipeline\Pipeline::prepareDestination():167}()
#45 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware-&gt;handle()
#46 /workspace/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#47 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Barryvdh\Debugbar\Middleware\InjectDebugbar-&gt;handle()
#48 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#49 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle()
#50 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle()
#51 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#52 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle()
#53 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle()
#54 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#55 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle()
#56 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(109): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#57 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle()
#58 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(48): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#59 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\HandleCors-&gt;handle()
#60 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#61 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\TrustProxies-&gt;handle()
#62 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#63 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle()
#64 /workspace/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#65 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(208): Illuminate\Http\Middleware\ValidatePathEncoding-&gt;handle()
#66 /workspace/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(126): Illuminate\Pipeline\Pipeline-&gt;{closure:{closure:Illuminate\Pipeline\Pipeline::carry():183}:184}()
#67 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline-&gt;then()
#68 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter()
#69 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle()
#70 /workspace/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase-&gt;call()
#71 /workspace/tests/Feature/Export/StockExportTest.php(25): Illuminate\Foundation\Testing\TestCase-&gt;get()
#72 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(1656): Tests\Feature\Export\StockExportTest-&gt;test_stock_pdf_export_returns_pdf()
#73 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(514): PHPUnit\Framework\TestCase-&gt;runTest()
#74 /workspace/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#75 /workspace/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner-&gt;run()
#76 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#77 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#78 /workspace/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#79 /workspace/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#80 /workspace/vendor/phpunit/phpunit/src/TextUI/Application.php(210): PHPUnit\TextUI\TestRunner-&gt;run()
#81 /workspace/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application-&gt;run()
#82 /workspace/vendor/bin/phpunit(122): include('...')
#83 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S02]: Base table or view not found: 1146 Table 'tenant_demo_test.purchases' doesn't exist (Connection: tenant, SQL: select * from `purchases` where `store_id` = 1 and `purchase_date` &lt; 2025-09-07 00:00:00 and exists (select * from `purchase_items` where `purchases`.`id` = `purchase_items`.`purchase_id` and `product_id` = 1))

/workspace/vendor/laravel/framework/src/Illuminate/Testing/TestResponseAssert.php:45
/workspace/vendor/laravel/framework/src/Illuminate/Testing/TestResponse.php:174
/workspace/tests/Feature/Export/StockExportTest.php:27</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\Export\TrialBalanceExportTest" file="/workspace/tests/Feature/Export/TrialBalanceExportTest.php" tests="1" assertions="4" errors="0" failures="0" skipped="0" time="0.262581">
        <testcase name="test_trial_balance_pdf_export_returns_pdf" file="/workspace/tests/Feature/Export/TrialBalanceExportTest.php" line="21" class="Tests\Feature\Export\TrialBalanceExportTest" classname="Tests.Feature.Export.TrialBalanceExportTest" assertions="4" time="0.262581"/>
      </testsuite>
      <testsuite name="Tests\Feature\Reports\ExportTest" file="/workspace/tests/Feature/Reports/ExportTest.php" tests="1" assertions="2" errors="0" failures="0" skipped="0" time="0.266156">
        <testcase name="test_sales_pdf_export_returns_pdf" file="/workspace/tests/Feature/Reports/ExportTest.php" line="21" class="Tests\Feature\Reports\ExportTest" classname="Tests.Feature.Reports.ExportTest" assertions="2" time="0.266156"/>
      </testsuite>
    </testsuite>
  </testsuite>
</testsuites>
